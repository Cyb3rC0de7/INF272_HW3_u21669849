@{
    ViewBag.Title = "Home - BikeStores Management";
}

<div class="container mt-4">
    <h1 class="mb-4">BikeStores Management System</h1>

    <!-- Staff -->
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h3 class="mb-0">Staff Members</h3>
        </div>
        <div class="card-body">
            <button type="button" class="btn btn-success mb-3" data-toggle="modal" data-target="#createStaffModal">
                <i class="fas fa-plus"></i> Add New Staff
            </button>

            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Store</th>
                        <th>Active</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var staff in ViewBag.Staffs)
                    {
                        <tr>
                            <td>@staff.first_name @staff.last_name</td>
                            <td>@staff.email</td>
                            <td>@staff.phone</td>
                            <td>@staff.stores.store_name</td>
                            <td>
                                @if (staff.active == 1)
                                {
                                    <span class="badge badge-success">Active</span>
                                }
                                else
                                {
                                    <span class="badge badge-secondary">Inactive</span>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

    <!-- Customer -->
    <div class="card mb-4">
        <div class="card-header bg-info text-white">
            <h3 class="mb-0">Customers</h3>
        </div>
        <div class="card-body">
            <button type="button" class="btn btn-success mb-3" data-toggle="modal" data-target="#createCustomerModal">
                <i class="fas fa-plus"></i> Add New Customer
            </button>

            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>City</th>
                        <th>State</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var customer in ViewBag.Customers)
                    {
                        <tr>
                            <td>@customer.first_name @customer.last_name</td>
                            <td>@customer.email</td>
                            <td>@customer.phone</td>
                            <td>@customer.city</td>
                            <td>@customer.state</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

    <!-- Products -->
    <div class="card mb-4">
        <div class="card-header bg-success text-white">
            <h3 class="mb-0">Products (Bicycles)</h3>
        </div>
        <div class="card-body">
            <!-- Filter -->
            <div class="row mb-3">
                <div class="col-md-4">
                    <label>Filter by Brand:</label>
                    <select id="brandFilter" class="form-control">
                        <option value="">All Brands</option>
                        @foreach (var brand in ViewBag.Brands)
                        {
                            <option value="@brand.brand_id">@brand.brand_name</option>
                        }
                    </select>
                </div>
                <div class="col-md-4">
                    <label>Filter by Category:</label>
                    <select id="categoryFilter" class="form-control">
                        <option value="">All Categories</option>
                        @foreach (var category in ViewBag.Categories)
                        {
                            <option value="@category.category_id">@category.category_name</option>
                        }
                    </select>
                </div>
            </div>

            <table class="table table-striped table-hover" id="productsTable">
                <thead>
                    <tr>
                        <th>Product Name</th>
                        <th>Brand</th>
                        <th>Category</th>
                        <th>Model Year</th>
                        <th>Price</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var product in ViewBag.Products)
                    {
                        <tr data-brand="@product.brand_id" data-category="@product.category_id">
                            <td>@product.product_name</td>
                            <td>@product.brands.brand_name</td>
                            <td>@product.categories.category_name</td>
                            <td>@product.model_year</td>
                            <td>$@product.list_price</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Create staff modal-->
<div class="modal fade" id="createStaffModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add New Staff</h5>
                <button type="button" class="close" data-dismiss="modal">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- add form-->
                <p>Form coming soon...</p>
            </div>
        </div>
    </div>
</div>

<!-- Create customer modal-->
<div class="modal fade" id="createCustomerModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add New Customer</h5>
                <button type="button" class="close" data-dismiss="modal">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- add form -->
                <p>Form coming soon...</p>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Product filtering with jQuery
        $(document).ready(function () {
            $('#brandFilter, #categoryFilter').on('change', function () {
                var selectedBrand = $('#brandFilter').val();
                var selectedCategory = $('#categoryFilter').val();

                $('#productsTable tbody tr').each(function () {
                    var row = $(this);
                    var brandMatch = !selectedBrand || row.data('brand') == selectedBrand;
                    var categoryMatch = !selectedCategory || row.data('category') == selectedCategory;

                    if (brandMatch && categoryMatch) {
                        row.show();
                    } else {
                        row.hide();
                    }
                });
            });
        });
    </script>
}